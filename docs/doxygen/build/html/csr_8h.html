<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>X2W-OS: /home/data/proj/oskernel2023-x2w/include/asm/csr.h 文件参考</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">X2W-OS
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">X2W参赛队作品</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_47b0152e0531aebd2c74f6f36a5c8382.html">asm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">宏定义</a>  </div>
  <div class="headertitle">
<div class="title">csr.h 文件参考</div>  </div>
</div><!--header-->
<div class="contents">

<p><code><a class="el" href="csr_8h.html" title="csr.h提供了读写RISC-V体系结构中的CSR寄存器(Control and Status)的函数">csr.h</a></code>提供了读写<code>RISC-V</code>体系结构中的<code>CSR</code>寄存器(<code>Control and Status</code>)的函数  
<a href="#details">更多...</a></p>

<p><a href="csr_8h_source.html">浏览源代码.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
宏定义</h2></td></tr>
<tr class="memitem:abe90ababbc031e196e373c27c729ecde"><td class="memItemLeft" align="right" valign="top"><a id="abe90ababbc031e196e373c27c729ecde"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_MODE_39</b>&#160;&#160;&#160;(1UL &lt;&lt; 63)</td></tr>
<tr class="separator:abe90ababbc031e196e373c27c729ecde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37ad3140d4956a01548f08823d84d0cc"><td class="memItemLeft" align="right" valign="top"><a id="a37ad3140d4956a01548f08823d84d0cc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a37ad3140d4956a01548f08823d84d0cc">PRIVILEGE_U</a>&#160;&#160;&#160;0UL</td></tr>
<tr class="memdesc:a37ad3140d4956a01548f08823d84d0cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">用户态特权级 <br /></td></tr>
<tr class="separator:a37ad3140d4956a01548f08823d84d0cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af76a15d4ca67c4f2def9490c764f5aa4"><td class="memItemLeft" align="right" valign="top"><a id="af76a15d4ca67c4f2def9490c764f5aa4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#af76a15d4ca67c4f2def9490c764f5aa4">PRIVILEGE_S</a>&#160;&#160;&#160;1UL</td></tr>
<tr class="memdesc:af76a15d4ca67c4f2def9490c764f5aa4"><td class="mdescLeft">&#160;</td><td class="mdescRight">监管态特权级 <br /></td></tr>
<tr class="separator:af76a15d4ca67c4f2def9490c764f5aa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61fcc9c63b58417818381f5d03420536"><td class="memItemLeft" align="right" valign="top"><a id="a61fcc9c63b58417818381f5d03420536"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a61fcc9c63b58417818381f5d03420536">PRIVILEGE_M</a>&#160;&#160;&#160;3UL</td></tr>
<tr class="memdesc:a61fcc9c63b58417818381f5d03420536"><td class="mdescLeft">&#160;</td><td class="mdescRight">机器态特权级 <br /></td></tr>
<tr class="separator:a61fcc9c63b58417818381f5d03420536"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93f797aa24a8dcc039cdb87774c979e2"><td class="memItemLeft" align="right" valign="top"><a id="a93f797aa24a8dcc039cdb87774c979e2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a93f797aa24a8dcc039cdb87774c979e2">INTR_DS</a>&#160;&#160;&#160;0UL</td></tr>
<tr class="memdesc:a93f797aa24a8dcc039cdb87774c979e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">中断开启 <br /></td></tr>
<tr class="separator:a93f797aa24a8dcc039cdb87774c979e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a918fc7ae0a636b642d2a37f5c2e963ab"><td class="memItemLeft" align="right" valign="top"><a id="a918fc7ae0a636b642d2a37f5c2e963ab"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a918fc7ae0a636b642d2a37f5c2e963ab">INTR_EN</a>&#160;&#160;&#160;1UL</td></tr>
<tr class="memdesc:a918fc7ae0a636b642d2a37f5c2e963ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">中断关闭 <br /></td></tr>
<tr class="separator:a918fc7ae0a636b642d2a37f5c2e963ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7a0e3b7853cd17e669f0f5da78cf905"><td class="memItemLeft" align="right" valign="top"><a id="ac7a0e3b7853cd17e669f0f5da78cf905"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#ac7a0e3b7853cd17e669f0f5da78cf905">MSTATUS_MPP_SHIFT</a>&#160;&#160;&#160;11</td></tr>
<tr class="memdesc:ac7a0e3b7853cd17e669f0f5da78cf905"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>MPP</code>域在<code>mstatus</code>寄存器的偏移 <br /></td></tr>
<tr class="separator:ac7a0e3b7853cd17e669f0f5da78cf905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2acf460f4ceda869c88c00878cb44314"><td class="memItemLeft" align="right" valign="top"><a id="a2acf460f4ceda869c88c00878cb44314"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a2acf460f4ceda869c88c00878cb44314">MSTATUS_MPP</a>&#160;&#160;&#160;(3UL &lt;&lt; <a class="el" href="csr_8h.html#ac7a0e3b7853cd17e669f0f5da78cf905">MSTATUS_MPP_SHIFT</a>)</td></tr>
<tr class="memdesc:a2acf460f4ceda869c88c00878cb44314"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>MPP</code>域选择子 <br /></td></tr>
<tr class="separator:a2acf460f4ceda869c88c00878cb44314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebc8dae20b3f619d03f0291db287f6de"><td class="memItemLeft" align="right" valign="top"><a id="aebc8dae20b3f619d03f0291db287f6de"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#aebc8dae20b3f619d03f0291db287f6de">MSTATUS_MPP_U</a>&#160;&#160;&#160;(<a class="el" href="csr_8h.html#a37ad3140d4956a01548f08823d84d0cc">PRIVILEGE_U</a> &lt;&lt; <a class="el" href="csr_8h.html#ac7a0e3b7853cd17e669f0f5da78cf905">MSTATUS_MPP_SHIFT</a>)</td></tr>
<tr class="memdesc:aebc8dae20b3f619d03f0291db287f6de"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>MPP = 0b00</code>, 中断发生前的特权级为U <br /></td></tr>
<tr class="separator:aebc8dae20b3f619d03f0291db287f6de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a484f2297ebe1535484c13f12f70e602a"><td class="memItemLeft" align="right" valign="top"><a id="a484f2297ebe1535484c13f12f70e602a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a484f2297ebe1535484c13f12f70e602a">MSTATUS_MPP_S</a>&#160;&#160;&#160;(<a class="el" href="csr_8h.html#af76a15d4ca67c4f2def9490c764f5aa4">PRIVILEGE_S</a> &lt;&lt; <a class="el" href="csr_8h.html#ac7a0e3b7853cd17e669f0f5da78cf905">MSTATUS_MPP_SHIFT</a>)</td></tr>
<tr class="memdesc:a484f2297ebe1535484c13f12f70e602a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>MPP = 0b01</code>, 中断发生前的特权级为S <br /></td></tr>
<tr class="separator:a484f2297ebe1535484c13f12f70e602a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6621785868a067469e73ac9babeed99"><td class="memItemLeft" align="right" valign="top"><a id="aa6621785868a067469e73ac9babeed99"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#aa6621785868a067469e73ac9babeed99">MSTATUS_MPP_M</a>&#160;&#160;&#160;(<a class="el" href="csr_8h.html#a61fcc9c63b58417818381f5d03420536">PRIVILEGE_M</a> &lt;&lt; <a class="el" href="csr_8h.html#ac7a0e3b7853cd17e669f0f5da78cf905">MSTATUS_MPP_SHIFT</a>)</td></tr>
<tr class="memdesc:aa6621785868a067469e73ac9babeed99"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>MPP = 0b11</code>, 中断发生前的特权级为M <br /></td></tr>
<tr class="separator:aa6621785868a067469e73ac9babeed99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b7a508b30cc8240d85c72373075130f"><td class="memItemLeft" align="right" valign="top"><a id="a5b7a508b30cc8240d85c72373075130f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a5b7a508b30cc8240d85c72373075130f">MSTATUS_MPIE_SHIFT</a>&#160;&#160;&#160;7</td></tr>
<tr class="memdesc:a5b7a508b30cc8240d85c72373075130f"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>MPIE</code>域在<code>mstatus</code>寄存器的偏移 <br /></td></tr>
<tr class="separator:a5b7a508b30cc8240d85c72373075130f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05fc511bb3d22b5e1abe8b9ccb30e7b3"><td class="memItemLeft" align="right" valign="top"><a id="a05fc511bb3d22b5e1abe8b9ccb30e7b3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a05fc511bb3d22b5e1abe8b9ccb30e7b3">MSTATUS_MPIE</a>&#160;&#160;&#160;(1UL &lt;&lt; <a class="el" href="csr_8h.html#a5b7a508b30cc8240d85c72373075130f">MSTATUS_MPIE_SHIFT</a>)</td></tr>
<tr class="memdesc:a05fc511bb3d22b5e1abe8b9ccb30e7b3"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>MPIE</code>域选择子 <br /></td></tr>
<tr class="separator:a05fc511bb3d22b5e1abe8b9ccb30e7b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d829111cf513e8d2ccf2ab434b17bdd"><td class="memItemLeft" align="right" valign="top"><a id="a0d829111cf513e8d2ccf2ab434b17bdd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a0d829111cf513e8d2ccf2ab434b17bdd">MSTATUS_MPIE_DS</a>&#160;&#160;&#160;(<a class="el" href="csr_8h.html#a93f797aa24a8dcc039cdb87774c979e2">INTR_DS</a> &lt;&lt; <a class="el" href="csr_8h.html#a5b7a508b30cc8240d85c72373075130f">MSTATUS_MPIE_SHIFT</a>)</td></tr>
<tr class="memdesc:a0d829111cf513e8d2ccf2ab434b17bdd"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>MPIE = 0</code>, 中断发生前中断关闭 <br /></td></tr>
<tr class="separator:a0d829111cf513e8d2ccf2ab434b17bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef6d2229ec2a9328ff08de7dea7cc9c"><td class="memItemLeft" align="right" valign="top"><a id="a6ef6d2229ec2a9328ff08de7dea7cc9c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a6ef6d2229ec2a9328ff08de7dea7cc9c">MSTATUS_MPIE_EN</a>&#160;&#160;&#160;(<a class="el" href="csr_8h.html#a918fc7ae0a636b642d2a37f5c2e963ab">INTR_EN</a> &lt;&lt; <a class="el" href="csr_8h.html#a5b7a508b30cc8240d85c72373075130f">MSTATUS_MPIE_SHIFT</a>)</td></tr>
<tr class="memdesc:a6ef6d2229ec2a9328ff08de7dea7cc9c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>MPIE = 1</code>, 中断发生前中断开启 <br /></td></tr>
<tr class="separator:a6ef6d2229ec2a9328ff08de7dea7cc9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fa813a9ac9c0fdd06b56201acd6a593"><td class="memItemLeft" align="right" valign="top"><a id="a9fa813a9ac9c0fdd06b56201acd6a593"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a9fa813a9ac9c0fdd06b56201acd6a593">TVEC_TRAP_DIRECT</a>&#160;&#160;&#160;(0b00)</td></tr>
<tr class="memdesc:a9fa813a9ac9c0fdd06b56201acd6a593"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>TVEC_TRAP_DIRECT</code>宏表示<code>mtvec</code>寄存器处于直接模式 <br /></td></tr>
<tr class="separator:a9fa813a9ac9c0fdd06b56201acd6a593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa12a22dbf2aa87997035c18f1b76c175"><td class="memItemLeft" align="right" valign="top"><a id="aa12a22dbf2aa87997035c18f1b76c175"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#aa12a22dbf2aa87997035c18f1b76c175">TVEC_TRAP_INDIRECT</a>&#160;&#160;&#160;(0b01)</td></tr>
<tr class="memdesc:aa12a22dbf2aa87997035c18f1b76c175"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>MTVEC_TRAP_INDIRECT</code>宏表示<code>mtvec</code>寄存器处于间接模式 <br /></td></tr>
<tr class="separator:aa12a22dbf2aa87997035c18f1b76c175"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef218b97155a1af82eb4129c309889ff"><td class="memItemLeft" align="right" valign="top"><a id="aef218b97155a1af82eb4129c309889ff"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#aef218b97155a1af82eb4129c309889ff">CAUSE_INTERRUPT_FLAG</a>&#160;&#160;&#160;(1UL &lt;&lt; 63)</td></tr>
<tr class="memdesc:aef218b97155a1af82eb4129c309889ff"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>CAUSE_INTERRUPT_FLAG</code>宏用于判断当前陷入是否为中断 <br /></td></tr>
<tr class="separator:aef218b97155a1af82eb4129c309889ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add33b6ebebec022bf3b124bf429482ac"><td class="memItemLeft" align="right" valign="top"><a id="add33b6ebebec022bf3b124bf429482ac"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#add33b6ebebec022bf3b124bf429482ac">CAUSE_EXCEPTION_FLAG</a>&#160;&#160;&#160;(0UL &lt;&lt; 64)</td></tr>
<tr class="memdesc:add33b6ebebec022bf3b124bf429482ac"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>CAUSE_EXCEPTION_FLAG</code>宏用于判断当前陷入是否为异常 <br /></td></tr>
<tr class="separator:add33b6ebebec022bf3b124bf429482ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa75388e27235c7b388af4f88ea4de30c"><td class="memItemLeft" align="right" valign="top"><a id="aa75388e27235c7b388af4f88ea4de30c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_MISALIGNED_FETCH</b>&#160;&#160;&#160;0x00</td></tr>
<tr class="separator:aa75388e27235c7b388af4f88ea4de30c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a415d18c5786e6465bb3b1bc8f3baeb21"><td class="memItemLeft" align="right" valign="top"><a id="a415d18c5786e6465bb3b1bc8f3baeb21"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_FETCH_ACCESS</b>&#160;&#160;&#160;0x01</td></tr>
<tr class="separator:a415d18c5786e6465bb3b1bc8f3baeb21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a290a6569311a1a437d368c3dfc19dd"><td class="memItemLeft" align="right" valign="top"><a id="a7a290a6569311a1a437d368c3dfc19dd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_ILLEGAL_INSTRUCTION</b>&#160;&#160;&#160;0x02</td></tr>
<tr class="separator:a7a290a6569311a1a437d368c3dfc19dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3a63cbefe5dbb40124e1c6282475606"><td class="memItemLeft" align="right" valign="top"><a id="ac3a63cbefe5dbb40124e1c6282475606"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_BREAKPOINT</b>&#160;&#160;&#160;0x03</td></tr>
<tr class="separator:ac3a63cbefe5dbb40124e1c6282475606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebf57c1677a8867b38a302d8649ee0ae"><td class="memItemLeft" align="right" valign="top"><a id="aebf57c1677a8867b38a302d8649ee0ae"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_MISALIGNED_LOAD</b>&#160;&#160;&#160;0x04</td></tr>
<tr class="separator:aebf57c1677a8867b38a302d8649ee0ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addec7d0bf0db39e50dc98929932e069f"><td class="memItemLeft" align="right" valign="top"><a id="addec7d0bf0db39e50dc98929932e069f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_LOAD_ACCESS</b>&#160;&#160;&#160;0x05</td></tr>
<tr class="separator:addec7d0bf0db39e50dc98929932e069f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1be2287df370d3ca2634a3dfb1c0fb65"><td class="memItemLeft" align="right" valign="top"><a id="a1be2287df370d3ca2634a3dfb1c0fb65"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_MISALIGNED_STORE</b>&#160;&#160;&#160;0x06</td></tr>
<tr class="separator:a1be2287df370d3ca2634a3dfb1c0fb65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbb82cc93014b07f9b16dd512cc4073e"><td class="memItemLeft" align="right" valign="top"><a id="afbb82cc93014b07f9b16dd512cc4073e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_STORE_ACCESS</b>&#160;&#160;&#160;0x07</td></tr>
<tr class="separator:afbb82cc93014b07f9b16dd512cc4073e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaf8b89d849833447273cb34b86314cc"><td class="memItemLeft" align="right" valign="top"><a id="aeaf8b89d849833447273cb34b86314cc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_USER_ECALL</b>&#160;&#160;&#160;0x08</td></tr>
<tr class="separator:aeaf8b89d849833447273cb34b86314cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ac310d1549659c056128c7e638baa10"><td class="memItemLeft" align="right" valign="top"><a id="a2ac310d1549659c056128c7e638baa10"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_SUPERVISOR_ECALL</b>&#160;&#160;&#160;0x09</td></tr>
<tr class="separator:a2ac310d1549659c056128c7e638baa10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22297fe99a059da2b933ac65465dcd53"><td class="memItemLeft" align="right" valign="top"><a id="a22297fe99a059da2b933ac65465dcd53"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_VIRTUAL_SUPERVISOR_ECALL</b>&#160;&#160;&#160;0x0A</td></tr>
<tr class="separator:a22297fe99a059da2b933ac65465dcd53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b6e1f90e8a71d8a408403f9dfeb11f0"><td class="memItemLeft" align="right" valign="top"><a id="a0b6e1f90e8a71d8a408403f9dfeb11f0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_MACHINE_ECALL</b>&#160;&#160;&#160;0x0B</td></tr>
<tr class="separator:a0b6e1f90e8a71d8a408403f9dfeb11f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa01619cb10a923eab5fbcab0e02328c0"><td class="memItemLeft" align="right" valign="top"><a id="aa01619cb10a923eab5fbcab0e02328c0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_FETCH_PAGE_FAULT</b>&#160;&#160;&#160;0x0C</td></tr>
<tr class="separator:aa01619cb10a923eab5fbcab0e02328c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6adb3513f1f1b2f7f5eb240738cb459b"><td class="memItemLeft" align="right" valign="top"><a id="a6adb3513f1f1b2f7f5eb240738cb459b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_LOAD_PAGE_FAULT</b>&#160;&#160;&#160;0x0D</td></tr>
<tr class="separator:a6adb3513f1f1b2f7f5eb240738cb459b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae520779fdaf92132d1158ff98b8d0090"><td class="memItemLeft" align="right" valign="top"><a id="ae520779fdaf92132d1158ff98b8d0090"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_STORE_PAGE_FAULT</b>&#160;&#160;&#160;0x0F</td></tr>
<tr class="separator:ae520779fdaf92132d1158ff98b8d0090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e34e7e27dbfedf1439841e7197055f4"><td class="memItemLeft" align="right" valign="top"><a id="a4e34e7e27dbfedf1439841e7197055f4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_FETCH_GUEST_PAGE_FAULT</b>&#160;&#160;&#160;0x14</td></tr>
<tr class="separator:a4e34e7e27dbfedf1439841e7197055f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae15cd727a3ff3f1170271c1789b18ff0"><td class="memItemLeft" align="right" valign="top"><a id="ae15cd727a3ff3f1170271c1789b18ff0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_LOAD_GUEST_PAGE_FAULT</b>&#160;&#160;&#160;0x15</td></tr>
<tr class="separator:ae15cd727a3ff3f1170271c1789b18ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29cb2113270261161ae62fbcc1757a0d"><td class="memItemLeft" align="right" valign="top"><a id="a29cb2113270261161ae62fbcc1757a0d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_VIRTUAL_INST_FAULT</b>&#160;&#160;&#160;0x16</td></tr>
<tr class="separator:a29cb2113270261161ae62fbcc1757a0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c3b6c845ff2ec0d59e899ea4a0761ab"><td class="memItemLeft" align="right" valign="top"><a id="a3c3b6c845ff2ec0d59e899ea4a0761ab"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_EXCEPTION_STORE_GUEST_PAGE_FAULT</b>&#160;&#160;&#160;0x17</td></tr>
<tr class="separator:a3c3b6c845ff2ec0d59e899ea4a0761ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdb78e038610d0741be3de20372433ce"><td class="memItemLeft" align="right" valign="top"><a id="abdb78e038610d0741be3de20372433ce"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_INTERRUPT_U_SOFTWARE_INTERRUPT</b>&#160;&#160;&#160;0x00</td></tr>
<tr class="separator:abdb78e038610d0741be3de20372433ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6cd48b2ed18acc2c8178b70cf05da41"><td class="memItemLeft" align="right" valign="top"><a id="ae6cd48b2ed18acc2c8178b70cf05da41"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_INTERRUPT_S_SOFTWARE_INTERRUPT</b>&#160;&#160;&#160;0x01</td></tr>
<tr class="separator:ae6cd48b2ed18acc2c8178b70cf05da41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80fdade90011f1312a6a56a7195f3040"><td class="memItemLeft" align="right" valign="top"><a id="a80fdade90011f1312a6a56a7195f3040"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_INTERRUPT_M_SOFTWARE_INTERRUPT</b>&#160;&#160;&#160;0x03</td></tr>
<tr class="separator:a80fdade90011f1312a6a56a7195f3040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ac68adf705b9331a4c94b159687d30d"><td class="memItemLeft" align="right" valign="top"><a id="a9ac68adf705b9331a4c94b159687d30d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_INTERRUPT_U_TIMER_INTERRUPT</b>&#160;&#160;&#160;0x04</td></tr>
<tr class="separator:a9ac68adf705b9331a4c94b159687d30d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1463e49018ac4b6a6ddf7670769b072"><td class="memItemLeft" align="right" valign="top"><a id="af1463e49018ac4b6a6ddf7670769b072"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_INTERRUPT_S_TIMER_INTERRUPT</b>&#160;&#160;&#160;0x05</td></tr>
<tr class="separator:af1463e49018ac4b6a6ddf7670769b072"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a160e1f44ce942d80e5f0e512673a8e3c"><td class="memItemLeft" align="right" valign="top"><a id="a160e1f44ce942d80e5f0e512673a8e3c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_INTERRUPT_M_TIMER_INTERRUPT</b>&#160;&#160;&#160;0x07</td></tr>
<tr class="separator:a160e1f44ce942d80e5f0e512673a8e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5fabf52b94702133bbb3d17046caf44"><td class="memItemLeft" align="right" valign="top"><a id="ab5fabf52b94702133bbb3d17046caf44"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_INTERRUPT_U_EXTERNAL_INTERRUPT</b>&#160;&#160;&#160;0x08</td></tr>
<tr class="separator:ab5fabf52b94702133bbb3d17046caf44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6099f1bd2cc677b042f9391773cece10"><td class="memItemLeft" align="right" valign="top"><a id="a6099f1bd2cc677b042f9391773cece10"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_INTERRUPT_S_EXTERNAL_INTERRUPT</b>&#160;&#160;&#160;0x09</td></tr>
<tr class="separator:a6099f1bd2cc677b042f9391773cece10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2b18dc42bfe5bc31ec1d0956b976efa"><td class="memItemLeft" align="right" valign="top"><a id="ae2b18dc42bfe5bc31ec1d0956b976efa"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CAUSE_INTERRUPT_M_EXTERNAL_INTERRUPT</b>&#160;&#160;&#160;0x11</td></tr>
<tr class="separator:ae2b18dc42bfe5bc31ec1d0956b976efa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a462f547447f3751fa2d55f04ba01fab6"><td class="memItemLeft" align="right" valign="top"><a id="a462f547447f3751fa2d55f04ba01fab6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIP_U_SOFTWARE_INTERRUPT</b>&#160;&#160;&#160;(1UL &lt;&lt; CAUSE_INTERRUPT_U_SOFTWARE_INTERRUPT)</td></tr>
<tr class="separator:a462f547447f3751fa2d55f04ba01fab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a110d08135f6f60deee9b7402955d731f"><td class="memItemLeft" align="right" valign="top"><a id="a110d08135f6f60deee9b7402955d731f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIP_S_SOFTWARE_INTERRUPT</b>&#160;&#160;&#160;(1UL &lt;&lt; CAUSE_INTERRUPT_S_SOFTWARE_INTERRUPT)</td></tr>
<tr class="separator:a110d08135f6f60deee9b7402955d731f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bfcda08e15446e332ee5c97e7451c1e"><td class="memItemLeft" align="right" valign="top"><a id="a1bfcda08e15446e332ee5c97e7451c1e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIP_M_SOFTWARE_INTERRUPT</b>&#160;&#160;&#160;(1UL &lt;&lt; CAUSE_INTERRUPT_M_SOFTWARE_INTERRUPT)</td></tr>
<tr class="separator:a1bfcda08e15446e332ee5c97e7451c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ecd0f900d49546be4cf57fd6a1402a5"><td class="memItemLeft" align="right" valign="top"><a id="a4ecd0f900d49546be4cf57fd6a1402a5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIP_U_TIMER_INTERRUPT</b>&#160;&#160;&#160;(1UL &lt;&lt; CAUSE_INTERRUPT_U_TIMER_INTERRUPT)</td></tr>
<tr class="separator:a4ecd0f900d49546be4cf57fd6a1402a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a023632324cde4e1787f61bf373bb6a38"><td class="memItemLeft" align="right" valign="top"><a id="a023632324cde4e1787f61bf373bb6a38"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIP_S_TIMER_INTERRUPT</b>&#160;&#160;&#160;(1UL &lt;&lt; CAUSE_INTERRUPT_S_TIMER_INTERRUPT)</td></tr>
<tr class="separator:a023632324cde4e1787f61bf373bb6a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7e7ae7a988b64226b794354bf6b57d1"><td class="memItemLeft" align="right" valign="top"><a id="af7e7ae7a988b64226b794354bf6b57d1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIP_M_TIMER_INTERRUPT</b>&#160;&#160;&#160;(1UL &lt;&lt; CAUSE_INTERRUPT_M_TIMER_INTERRUPT)</td></tr>
<tr class="separator:af7e7ae7a988b64226b794354bf6b57d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a575942391b8f0686bec79151eeadb82e"><td class="memItemLeft" align="right" valign="top"><a id="a575942391b8f0686bec79151eeadb82e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIP_U_EXTERNAL_INTERRUPT</b>&#160;&#160;&#160;(1UL &lt;&lt; CAUSE_INTERRUPT_U_EXTERNAL_INTERRUPT)</td></tr>
<tr class="separator:a575942391b8f0686bec79151eeadb82e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00ed7cdf31f5a872f798ed2240efbd8"><td class="memItemLeft" align="right" valign="top"><a id="ab00ed7cdf31f5a872f798ed2240efbd8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIP_S_EXTERNAL_INTERRUPT</b>&#160;&#160;&#160;(1UL &lt;&lt; CAUSE_INTERRUPT_S_EXTERNAL_INTERRUPT)</td></tr>
<tr class="separator:ab00ed7cdf31f5a872f798ed2240efbd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a297777e25396598b0ea467b6e8187ec3"><td class="memItemLeft" align="right" valign="top"><a id="a297777e25396598b0ea467b6e8187ec3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MIP_M_EXTERNAL_INTERRUPT</b>&#160;&#160;&#160;(1UL &lt;&lt; CAUSE_INTERRUPT_M_EXTERNAL_INTERRUPT)</td></tr>
<tr class="separator:a297777e25396598b0ea467b6e8187ec3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea23c529d81311e98bf5756f13e20b53"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#aea23c529d81311e98bf5756f13e20b53">SET_FIELD</a>(origin,  which,  fieldval)&#160;&#160;&#160;(((origin) &amp; ~(which)) | ((fieldval) * ((which) &amp; ~((which) - 1))))</td></tr>
<tr class="memdesc:aea23c529d81311e98bf5756f13e20b53"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>SET_FIELD</code>宏用于将<code>origin</code>中<code>which</code>所指定的<code>field</code>的值设置为<code>fieldval</code>  <a href="csr_8h.html#aea23c529d81311e98bf5756f13e20b53">更多...</a><br /></td></tr>
<tr class="separator:aea23c529d81311e98bf5756f13e20b53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29cc2e18dc58da69b8d351a52e193df9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a29cc2e18dc58da69b8d351a52e193df9">read_csr</a>(csr)</td></tr>
<tr class="memdesc:a29cc2e18dc58da69b8d351a52e193df9"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>read_csr</code>用于读取的<code>csr</code>寄存器的值并返回  <a href="csr_8h.html#a29cc2e18dc58da69b8d351a52e193df9">更多...</a><br /></td></tr>
<tr class="separator:a29cc2e18dc58da69b8d351a52e193df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a920ec7be97d0deaaf7e4734fb062c555"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="csr_8h.html#a920ec7be97d0deaaf7e4734fb062c555">write_csr</a>(csr,  value)</td></tr>
<tr class="memdesc:a920ec7be97d0deaaf7e4734fb062c555"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>write_csr</code>用于将<code>csr</code>寄存器的值设置为<code>value</code>  <a href="csr_8h.html#a920ec7be97d0deaaf7e4734fb062c555">更多...</a><br /></td></tr>
<tr class="separator:a920ec7be97d0deaaf7e4734fb062c555"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">详细描述</h2>
<div class="textblock"><p><code><a class="el" href="csr_8h.html" title="csr.h提供了读写RISC-V体系结构中的CSR寄存器(Control and Status)的函数">csr.h</a></code>提供了读写<code>RISC-V</code>体系结构中的<code>CSR</code>寄存器(<code>Control and Status</code>)的函数 </p>
<dl class="section author"><dt>作者</dt><dd>Shihong Wang (<a href="#" onclick="location.href='mai'+'lto:'+'jac'+'k4'+'shi'+'ho'+'ng@'+'ga'+'mil'+'.c'+'om'; return false;">jack4<span style="display: none;">.nosp@m.</span>shih<span style="display: none;">.nosp@m.</span>ong@g<span style="display: none;">.nosp@m.</span>amil<span style="display: none;">.nosp@m.</span>.com</a>) </dd></dl>
<dl class="section version"><dt>版本</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>日期</dt><dd>2023-04-09</dd></dl>
<dl class="section note"><dt>注解</dt><dd>参考RISC-V架构手册:<ol type="1">
<li><a href="https://github.com/riscv/riscv-isa-manual/releases/download/Ratified-IMAFDQC/riscv-spec-20191213.pdf">https://github.com/riscv/riscv-isa-manual/releases/download/Ratified-IMAFDQC/riscv-spec-20191213.pdf</a></li>
<li><a href="https://github.com/riscv/riscv-isa-manual/releases/download/Priv-v1.12/riscv-privileged-20211203.pdf">https://github.com/riscv/riscv-isa-manual/releases/download/Priv-v1.12/riscv-privileged-20211203.pdf</a></li>
</ol>
</dd>
<dd>
一些有用的博客:<ol type="1">
<li><a href="https://dingfen.github.io/risc-v/2020/08/05/riscv-privileged.html#%E4%B8%AD%E6%96%AD%E4%B8%8E%E5%BC%82%E5%B8%B8">https://dingfen.github.io/risc-v/2020/08/05/riscv-privileged.html#%E4%B8%AD%E6%96%AD%E4%B8%8E%E5%BC%82%E5%B8%B8</a> </li>
</ol>
</dd></dl>
<dl class="section copyright"><dt>版权所有</dt><dd>Copyright Shihong Wang (c) 2023 with GNU Public License V3.0 </dd></dl>
</div><h2 class="groupheader">宏定义说明</h2>
<a id="a29cc2e18dc58da69b8d351a52e193df9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29cc2e18dc58da69b8d351a52e193df9">&#9670;&nbsp;</a></span>read_csr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define read_csr</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">csr</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>值:</b><div class="fragment"><div class="line">    ({                            \</div>
<div class="line">    register <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> __v;                     \</div>
<div class="line">    asm <span class="keyword">volatile</span>(                                   \</div>
<div class="line">        <span class="stringliteral">&quot;csrr %0, &quot;</span> #csr                            \</div>
<div class="line">        : <span class="stringliteral">&quot;=r&quot;</span> (__v)                                \</div>
<div class="line">        :                                           \</div>
<div class="line">        : <span class="stringliteral">&quot;memory&quot;</span>                                  \</div>
<div class="line">    );                                              \</div>
<div class="line">    __v;                                            \</div>
<div class="line">})</div>
</div><!-- fragment -->
<p><code>read_csr</code>用于读取的<code>csr</code>寄存器的值并返回 </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">csr</td><td>要读取的<code>CSR</code>寄存器名</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>返回</dt><dd>uint64_t 读取得到的<code>csr</code>寄存器的值</dd></dl>
<dl class="section note"><dt>注解</dt><dd>通常情况下，在内联汇编代码块的最后一条语句中将需要返回的值存储在一个特定的变量中，然后该变量将被作为代码块的返回值返回给调用者。在GCC扩展中，这个变量通常被命名为__v（两个下划线 + v），并且在代码块的最后一行写上__v;语句来表示将其作为返回值返回给调用者。 </dd>
<dd>
写入到<code>CSR</code>寄存器的变量必须要存在通用寄存器中 </dd>
<dd>
<code>read_csr</code>中使用<code>#</code>将<code>csr</code>转为字符串, 而后利用<code>C</code>语言的字符串拼接得到最终的汇编语句 </dd></dl>

</div>
</div>
<a id="aea23c529d81311e98bf5756f13e20b53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea23c529d81311e98bf5756f13e20b53">&#9670;&nbsp;</a></span>SET_FIELD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SET_FIELD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">origin, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">which, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fieldval&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((origin) &amp; ~(which)) | ((fieldval) * ((which) &amp; ~((which) - 1))))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>SET_FIELD</code>宏用于将<code>origin</code>中<code>which</code>所指定的<code>field</code>的值设置为<code>fieldval</code> </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">origin</td><td>初始值 </td></tr>
    <tr><td class="paramname">which</td><td>设置的<code>field</code> </td></tr>
    <tr><td class="paramname">fieldval</td><td><code>field</code>将被设置的值</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>注解</dt><dd>需要注意的点:<ul>
<li><code>x &amp; ~mask</code>: 将x的非<code>mask</code>清0</li>
<li><code>x &amp; ~(x - 1)</code>: 用于一个数的二进制表示中最右边的非零位（也称作最低位的1），并将其它位都置为0</li>
<li>而后利用这个最右边的非零位表示需要左移多少位, 这里是用乘法实现的左移</li>
<li>最后在和mask对应位清0之后的原值与就能得到最终需要的值</li>
</ul>
</dd></dl>
<p>一个详细的例子<code>origin = 0b1001_0001</code>, <code>which = 0b0011_0000</code>, <code>fieldval = 0b11</code>则:</p><ul>
<li><code>which &amp; ~(which - 1) = 0b0001_0000</code></li>
<li><code>fieldval * (which &amp; ~(which - 1)) = 0b0011_0000</code></li>
<li><code>origin &amp; !(which) = 0b1011_0001</code></li>
<li><code>... | ... = 0b1000_0000</code> </li>
</ul>

</div>
</div>
<a id="a920ec7be97d0deaaf7e4734fb062c555"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a920ec7be97d0deaaf7e4734fb062c555">&#9670;&nbsp;</a></span>write_csr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define write_csr</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">csr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">value&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>值:</b><div class="fragment"><div class="line">    ({                    \</div>
<div class="line">    unsigned <span class="keywordtype">long</span> __v = (<span class="keywordtype">unsigned</span> long) (value);    \</div>
<div class="line">    __asm__ __volatile__(                           \</div>
<div class="line">        <span class="stringliteral">&quot;csrw &quot;</span> #csr <span class="stringliteral">&quot;, %0&quot;</span>                         \</div>
<div class="line">        :                                           \</div>
<div class="line">        : <span class="stringliteral">&quot;rK&quot;</span> (__v)                                \</div>
<div class="line">        : <span class="stringliteral">&quot;memory&quot;</span>                                  \</div>
<div class="line">    );                                              \</div>
<div class="line">})</div>
</div><!-- fragment -->
<p><code>write_csr</code>用于将<code>csr</code>寄存器的值设置为<code>value</code> </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">csr</td><td>要设置的<code>CSR</code>寄存器名 </td></tr>
    <tr><td class="paramname">value</td><td>要设置的值</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>注解</dt><dd><code>rK</code>约束参考, <code>r</code>是简单约束, <code>K</code>是<code>RISC-V</code>的机器限定约束:<ol type="1">
<li><a href="https://gcc.gnu.org/onlinedocs/gcc/Simple-Constraints.html">https://gcc.gnu.org/onlinedocs/gcc/Simple-Constraints.html</a></li>
<li><a href="https://gcc.gnu.org/onlinedocs/gcc/Machine-Constraints.html">https://gcc.gnu.org/onlinedocs/gcc/Machine-Constraints.html</a> </li>
</ol>
</dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者 &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
